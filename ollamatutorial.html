<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ollama Setup Guide</title>
    <style>
        /* Ïä§ÌÉÄÏùºÏùÄ Ïù¥Ï†ÑÍ≥º ÎèôÏùºÌï©ÎãàÎã§ */
        :root { --primary-color: #000; --accent-color: #2563eb; --bg-color: #f8f9fa; --text-color: #333; --code-bg: #1e1e1e; --code-text: #d4d4d4; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.6; margin: 0; padding: 0; background: var(--bg-color); color: var(--text-color); }
        .container { max-width: 800px; margin: 40px auto; padding: 20px; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); position: relative; }
        .lang-switch { position: absolute; top: 20px; right: 20px; font-size: 14px; }
        .lang-switch a { color: #666; text-decoration: none; cursor: pointer; margin-left: 10px; }
        .lang-switch a.active { color: var(--accent-color); font-weight: bold; }
        
        /* Language Dropdown */
        .lang-dropdown { position: relative; display: inline-block; }
        .lang-dropdown-btn {
          background: #fff;
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 6px 12px;
          font-size: 14px;
          cursor: pointer;
          color: #333;
          display: flex;
          align-items: center;
          gap: 6px;
          transition: all 0.2s;
        }
        .lang-dropdown-btn:hover {
          background: #f5f5f5;
          border-color: var(--accent-color);
        }
        .lang-dropdown-menu {
          position: absolute;
          top: 100%;
          right: 0;
          margin-top: 4px;
          background: #fff;
          border: 1px solid #ddd;
          border-radius: 8px;
          box-shadow: 0 4px 20px rgba(0,0,0,0.1);
          max-height: 400px;
          overflow-y: auto;
          min-width: 180px;
          display: none;
          z-index: 1000;
        }
        .lang-dropdown-menu.show { display: block; }
        .lang-dropdown-item {
          padding: 8px 16px;
          cursor: pointer;
          color: #333;
          font-size: 14px;
          transition: background 0.2s;
          border-bottom: 1px solid #eee;
        }
        .lang-dropdown-item:last-child { border-bottom: none; }
        .lang-dropdown-item:hover {
          background: #f5f5f5;
          color: var(--accent-color);
        }
        .lang-dropdown-item.active {
          background: #f5f5f5;
          color: var(--accent-color);
          font-weight: 600;
        }
        header { text-align: center; margin: 20px 0 40px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
        h1 { margin: 0 0 10px 0; }
        p.subtitle { color: #666; margin: 0; }
        .tabs { display: flex; justify-content: center; margin-bottom: 30px; border-bottom: 2px solid #eee; }
        .tab-btn { padding: 12px 24px; border: none; background: none; cursor: pointer; font-size: 16px; font-weight: 600; color: #888; border-bottom: 2px solid transparent; }
        .tab-btn:hover { color: var(--accent-color); }
        .tab-btn.active { color: var(--primary-color); border-bottom: 2px solid var(--primary-color); }
        .content-section { display: none; animation: fadeIn 0.5s; }
        .content-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: 0; } }
        .step { margin-bottom: 25px; padding-left: 20px; border-left: 3px solid var(--accent-color); }
        .step h3 { margin-top: 0; color: var(--primary-color); }
        .code-block { background: var(--code-bg); color: var(--code-text); padding: 15px; border-radius: 6px; font-family: monospace; position: relative; overflow-x: auto; margin: 10px 0; }
        .copy-btn { position: absolute; top: 5px; right: 5px; background: rgba(255,255,255,0.2); border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px; }
        .btn-download { display: inline-block; background: var(--primary-color); color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; font-weight: bold; margin-top: 10px; }
        .note { background: #fff3cd; border: 1px solid #ffeeba; color: #856404; padding: 10px; border-radius: 6px; font-size: 14px; margin-top: 10px; }
        footer { text-align: center; margin-top: 50px; font-size: 13px; color: #999; }
    </style>
</head>
<body>

<div class="container">
    <div class="lang-switch">
        <div class="lang-dropdown">
          <button class="lang-dropdown-btn" onclick="toggleLangDropdown()">
            <span id="current-lang-name">English</span>
            <span>‚ñº</span>
          </button>
          <div class="lang-dropdown-menu" id="lang-dropdown-menu"></div>
        </div>
    </div>

    <header>
        <h1 data-i18n="title">Ollama Setup Guide</h1>
        <p class="subtitle" data-i18n="subtitle">Please install Ollama to enable AI features.</p>
    </header>

    <div class="tabs">
        <button class="tab-btn active" onclick="openTab('windows')" data-i18n="win_tab">Windows</button>
        <button class="tab-btn" onclick="openTab('macos')" data-i18n="mac_tab">macOS</button>
        <button class="tab-btn" onclick="openTab('ubuntu')" data-i18n="linux_tab">Ubuntu</button>
    </div>

    <div id="windows" class="content-section active">
        <div class="step">
            <h3 data-i18n="win_step1_title">1. Download Installer</h3>
            <p data-i18n="win_step1_desc">Download the installer for Windows from the official website.</p>
            <a href="https://ollama.com/download/windows" target="_blank" class="btn-download" data-i18n="win_btn">Download for Windows</a>
        </div>
        <div class="step">
            <h3 data-i18n="win_step2_title">2. Install</h3>
            <p data-i18n="win_step2_desc">Run the <code>OllamaSetup.exe</code> file and click [Install].</p>
            <div class="note" data-i18n="win_step2_note">‚úÖ Once installed, you will see the Alpaca icon (ü¶ô) in the taskbar tray.</div>
        </div>
        <div class="step">
            <h3 data-i18n="win_step3_title">3. Verify Installation</h3>
            <p data-i18n="win_step3_desc">Open Command Prompt (Win + R, type <code>cmd</code>) and run the command below:</p>
            <div class="code-block">
                ollama --version
                <button class="copy-btn" onclick="copyText(this)" data-i18n="copy">Copy</button>
            </div>
        </div>
    </div>

    <div id="macos" class="content-section">
        <div class="step">
            <h3 data-i18n="mac_step1_title">1. Download</h3>
            <p data-i18n="mac_step1_desc">Requires macOS 11 Big Sur or later.</p>
            <a href="https://ollama.com/download/mac" target="_blank" class="btn-download" data-i18n="mac_btn">Download for macOS</a>
        </div>
        <div class="step">
            <h3 data-i18n="mac_step2_title">2. Install Application</h3>
            <p data-i18n="mac_step2_desc">Unzip the file and move the <strong>Ollama</strong> app to the <code>Applications</code> folder.</p>
        </div>
        <div class="step">
            <h3 data-i18n="mac_step3_title">3. Run & Setup</h3>
            <p data-i18n="mac_step3_desc">Double-click to run. You should see the Alpaca icon (ü¶ô) in the menu bar.</p>
            <div class="note" data-i18n="mac_step3_note">üí° If prompted to install command line tools, click 'Install'.</div>
        </div>
    </div>

    <div id="ubuntu" class="content-section">
        <div class="step">
            <h3 data-i18n="linux_step1_title">1. Install via Terminal</h3>
            <p data-i18n="linux_step1_desc">Open your terminal and run the following command:</p>
            <div class="code-block">
                curl -fsSL https://ollama.com/install.sh | sh
                <button class="copy-btn" onclick="copyText(this)" data-i18n="copy">Copy</button>
            </div>
            <div class="note" data-i18n="linux_step1_note">‚ö†Ô∏è AMD graphics cards may require additional driver installation.</div>
        </div>
        <div class="step">
            <h3 data-i18n="linux_step2_title">2. Check Service Status</h3>
            <p data-i18n="linux_step2_desc">Ensure Ollama is running in the background.</p>
            <div class="code-block">
                systemctl status ollama
                <button class="copy-btn" onclick="copyText(this)" data-i18n="copy">Copy</button>
            </div>
        </div>
    </div>

    <hr style="margin: 40px 0; border: 0; border-top: 1px solid #eee;">
    <div class="step">
        <h3 data-i18n="final_step_title">üéâ Final Step: Pull AI Model</h3>
        <p data-i18n="final_step_desc">After installation, you must download the AI model. Run this in your terminal:</p>
        <div class="code-block">
            ollama pull llama3.2
            <button class="copy-btn" onclick="copyText(this)" data-i18n="copy">Copy</button>
        </div>
        <div class="note" data-i18n="final_step_note">üí° If your app requires a specific model (e.g., mistral), replace 'llama3.2' with that name.</div>
    </div>

    <footer data-i18n="footer">&copy; 2025 Powered by Ollama.</footer>
</div>

<script>
    // Language configuration
    const LANGUAGES = [
      { code: 'ar', name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©' },
      { code: 'ca', name: 'Catal√†' },
      { code: 'cs', name: 'ƒåe≈°tina' },
      { code: 'da', name: 'Dansk' },
      { code: 'de', name: 'Deutsch' },
      { code: 'el', name: 'ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨' },
      { code: 'en', name: 'English' },
      { code: 'es', name: 'Espa√±ol' },
      { code: 'es-MX', name: 'Espa√±ol (M√©xico)' },
      { code: 'fi', name: 'Suomi' },
      { code: 'fr', name: 'Fran√ßais' },
      { code: 'fr-CA', name: 'Fran√ßais (Canada)' },
      { code: 'he', name: '◊¢◊ë◊®◊ô◊™' },
      { code: 'hi', name: '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä' },
      { code: 'hr', name: 'Hrvatski' },
      { code: 'hu', name: 'Magyar' },
      { code: 'id', name: 'Bahasa Indonesia' },
      { code: 'it', name: 'Italiano' },
      { code: 'ja', name: 'Êó•Êú¨Ë™û' },
      { code: 'ko', name: 'ÌïúÍµ≠Ïñ¥' },
      { code: 'ms', name: 'Bahasa Melayu' },
      { code: 'nb', name: 'Norsk Bokm√•l' },
      { code: 'pl', name: 'Polski' },
      { code: 'pt-BR', name: 'Portugu√™s (Brasil)' },
      { code: 'pt-PT', name: 'Portugu√™s (Portugal)' },
      { code: 'ro', name: 'Rom√¢nƒÉ' },
      { code: 'ru', name: '–†—É—Å—Å–∫–∏–π' },
      { code: 'sk', name: 'Slovenƒçina' },
      { code: 'sv', name: 'Svenska' },
      { code: 'th', name: '‡πÑ‡∏ó‡∏¢' },
      { code: 'tr', name: 'T√ºrk√ße' },
      { code: 'uk', name: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' },
      { code: 'vi', name: 'Ti·∫øng Vi·ªát' },
      { code: 'zh-Hans', name: 'ÁÆÄ‰Ωì‰∏≠Êñá' },
      { code: 'zh-Hant', name: 'ÁπÅÈ´î‰∏≠Êñá' }
    ];

    let currentLang = 'en';
    let translations = {};

    // Initialize language dropdown
    function initLangDropdown() {
      const menu = document.getElementById('lang-dropdown-menu');
      LANGUAGES.forEach(lang => {
        const item = document.createElement('div');
        item.className = 'lang-dropdown-item';
        item.textContent = lang.name;
        item.onclick = () => setLanguage(lang.code);
        menu.appendChild(item);
      });
    }

    function toggleLangDropdown() {
      const menu = document.getElementById('lang-dropdown-menu');
      menu.classList.toggle('show');
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', (e) => {
      const dropdown = document.querySelector('.lang-dropdown');
      if (dropdown && !dropdown.contains(e.target)) {
        document.getElementById('lang-dropdown-menu').classList.remove('show');
      }
    });

    async function loadLocale(lang) {
      try {
        const res = await fetch(`./locales/${lang}.json`, { cache: "no-store" });
        if (!res.ok) throw new Error("Failed to load locale: " + lang);
        return await res.json();
      } catch (error) {
        console.warn(`Failed to load ${lang}.json, falling back to en.json`);
        try {
          const res = await fetch(`./locales/en.json`, { cache: "no-store" });
          if (!res.ok) return null;
          return await res.json();
        } catch (e) {
          return null;
        }
      }
    }

    async function setLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('ollama_lang', lang);

      // Load translations
      const dict = await loadLocale(lang);
      if (!dict) {
        console.error('Failed to load locale:', lang);
        return;
      }
      translations[lang] = dict;

      // Apply translations - use ollama namespace
      const ollamaDict = dict.ollama;
      if (!ollamaDict) {
        console.error('ollama namespace not found in locale:', lang);
        console.error('Available keys in dict:', Object.keys(dict));
        return;
      }
      
      console.log('Loading ollama translations, available keys:', Object.keys(ollamaDict).slice(0, 10));
      
      const elements = document.querySelectorAll('[data-i18n]');
      let appliedCount = 0;
      let missingCount = 0;
      
      elements.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (!key) return;
        
        // Get value from ollama namespace
        let value = ollamaDict[key];
        
        // If not found, try nested path
        if (value == null || value === undefined) {
          const keys = key.split('.');
          let temp = ollamaDict;
          for (const k of keys) {
            if (temp && typeof temp === 'object' && temp[k] != null) {
              temp = temp[k];
            } else {
              temp = null;
              break;
            }
          }
          value = temp;
        }
        
        if (value != null && value !== undefined) {
          el.innerHTML = value;
          appliedCount++;
        } else {
          console.warn('Translation not found for key:', key);
          missingCount++;
        }
      });
      
      console.log(`Applied ${appliedCount} translations, ${missingCount} missing`);

      // Update dropdown UI
      const langInfo = LANGUAGES.find(l => l.code === lang);
      if (langInfo) {
        document.getElementById('current-lang-name').textContent = langInfo.name;
      }
      
      // Update active state in dropdown
      document.querySelectorAll('.lang-dropdown-item').forEach(item => {
        item.classList.remove('active');
        if (item.textContent === langInfo.name) {
          item.classList.add('active');
        }
      });

      document.documentElement.lang = dict._meta?.htmlLang || lang;
      
      // Close dropdown
      document.getElementById('lang-dropdown-menu').classList.remove('show');
    }

    async function detectAndApplyLanguage() {
      const saved = localStorage.getItem('ollama_lang');
      if (saved && LANGUAGES.find(l => l.code === saved)) {
        await setLanguage(saved);
        return;
      }

      const nav = (navigator.language || "en").toLowerCase();
      // Try to match language
      for (const lang of LANGUAGES) {
        if (nav.startsWith(lang.code.split('-')[0])) {
          await setLanguage(lang.code);
          return;
        }
      }
      await setLanguage('en');
    }

    function openTab(tabName) {
        // ÌÉ≠ UI Ï†ÑÌôò Î°úÏßÅ
        Array.from(document.getElementsByClassName("content-section")).forEach(el => el.classList.remove("active"));
        Array.from(document.getElementsByClassName("tab-btn")).forEach(el => el.classList.remove("active"));
        
        document.getElementById(tabName).classList.add("active");
        
        // ÌÅ¥Î¶≠Îêú Î≤ÑÌäºÏùÑ Ï∞æÏïÑ active Ï∂îÍ∞Ä (Ïù¥Î≤§Ìä∏ ÌÉÄÍ≤üÏù¥ Ï†ïÌôïÌïòÏßÄ ÏïäÏùÑ Í≤ΩÏö∞ ÎåÄÎπÑ)
        const buttons = document.getElementsByClassName("tab-btn");
        for(let btn of buttons) {
            if(btn.onclick.toString().includes(tabName)) {
                btn.classList.add("active");
            }
        }
    }

    function copyText(btn) {
        var text = btn.parentElement.innerText.replace(btn.innerText, "").trim();
        navigator.clipboard.writeText(text).then(function() {
            const dict = translations[currentLang] || {};
            const ollamaDict = dict.ollama || {};
            const originalText = ollamaDict.copy || dict.copy || 'Copy';
            btn.innerText = ollamaDict.copied || dict.copied || 'Copied!';
            setTimeout(function() {
                btn.innerText = originalText;
            }, 2000);
        });
    }

    // Initialize
    initLangDropdown();
    
    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïã§Ìñâ
    window.onload = function() {
      detectAndApplyLanguage().catch(err => {
        console.error('Error loading language:', err);
        // Fallback: try to load English directly
        setLanguage('en');
      });
    };
</script>

</body>
</html>